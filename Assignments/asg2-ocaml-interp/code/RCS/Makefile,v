head	1.31;
access;
symbols;
locks;
comment	@# @;


1.31
date	2021.02.04.19.42.15;	author -;	state -;
branches;
next	1.30;

1.30
date	2021.02.04.19.40.43;	author -;	state -;
branches;
next	1.29;

1.29
date	2021.02.04.19.39.48;	author -;	state -;
branches;
next	1.28;

1.28
date	2021.01.29.19.08.27;	author -;	state -;
branches;
next	1.27;

1.27
date	2021.01.26.17.57.09;	author -;	state -;
branches;
next	1.26;

1.26
date	2021.01.26.17.56.33;	author -;	state -;
branches;
next	1.25;

1.25
date	2020.10.29.17.19.55;	author -;	state -;
branches;
next	1.24;

1.24
date	2020.10.22.23.22.53;	author -;	state -;
branches;
next	1.23;

1.23
date	2020.10.22.19.41.43;	author -;	state -;
branches;
next	1.22;

1.22
date	2020.10.22.19.38.08;	author -;	state -;
branches;
next	1.21;

1.21
date	2020.10.22.19.33.57;	author -;	state -;
branches;
next	1.20;

1.20
date	2020.10.22.19.29.24;	author -;	state -;
branches;
next	1.19;

1.19
date	2020.09.07.03.49.42;	author -;	state -;
branches;
next	1.18;

1.18
date	2020.08.18.22.53.03;	author -;	state -;
branches;
next	1.17;

1.17
date	2020.08.17.07.02.07;	author -;	state -;
branches;
next	1.16;

1.16
date	2020.01.29.00.12.50;	author -;	state -;
branches;
next	1.15;

1.15
date	2020.01.24.20.54.40;	author -;	state -;
branches;
next	1.14;

1.14
date	2020.01.24.20.43.15;	author -;	state -;
branches;
next	1.13;

1.13
date	2020.01.24.19.50.00;	author -;	state -;
branches;
next	1.12;

1.12
date	2020.01.17.22.21.56;	author -;	state -;
branches;
next	1.11;

1.11
date	2019.02.15.00.13.28;	author -;	state -;
branches;
next	1.10;

1.10
date	2019.02.15.00.13.05;	author -;	state -;
branches;
next	1.9;

1.9
date	2019.02.15.00.10.09;	author -;	state -;
branches;
next	1.8;

1.8
date	2019.01.26.00.48.22;	author -;	state -;
branches;
next	1.7;

1.7
date	2019.01.26.00.42.31;	author -;	state -;
branches;
next	1.6;

1.6
date	2019.01.25.22.50.51;	author -;	state -;
branches;
next	1.5;

1.5
date	2019.01.25.01.51.18;	author -;	state -;
branches;
next	1.4;

1.4
date	2019.01.25.01.08.37;	author -;	state -;
branches;
next	1.3;

1.3
date	2019.01.25.00.25.00;	author -;	state -;
branches;
next	1.2;

1.2
date	2019.01.25.00.14.37;	author -;	state -;
branches;
next	1.1;

1.1
date	2019.01.24.23.47.38;	author -;	state -;
branches;
next	;


desc
@@


1.31
log
@-
@
text
@# $Id: Makefile,v 1.30 2021-02-04 11:40:43-08 - - $

#
# General useful macros
#

MKFILE     = Makefile
MAKEFLAGS += --no-builtin-rules
DEPFILE    = ${MKFILE}.dep
NOINCLUDE  = ci clean spotless check
NEEDINCL   = ${filter ${NOINCLUDE}, ${MAKECMDGOALS}}
GMAKE      = ${MAKE} --no-print-directory
OCAMLOPT   = ocamlopt -g

#
# File macros
#

EXECBIN    = mbinterp
OBJCMX     = etc.cmx parser.cmx scanner.cmx tables.cmx \
             dumper.cmx interp.cmx main.cmx
OBJCMI     = ${OBJCMX:.cmx=.cmi} absyn.cmi
OBJBIN     = ${OBJCMX:.cmx=.o}
MLSOURCE   = absyn.mli etc.mli etc.ml tables.mli tables.ml \
             dumper.mli dumper.ml interp.mli interp.ml main.ml
GENLEXYACC = parser.mli parser.ml scanner.ml
GENSOURCE  = dumper.mli tables.mli ${GENLEXYACC}
GENFILES   = ${GENSOURCE} parser.output ${DEPFILE}
OTHERFILES = ${MKFILE} using
ALLSOURCES = ${MLSOURCE} parser.mly scanner.mll ${OTHERFILES}
LISTING    = Listing.ps

SCRIPTBIN  = /afs/cats.ucsc.edu/courses/cse112-wm/bin
OCAMLBIN   = /afs/cats.ucsc.edu/courses/cse112-wm/usr/ocaml-4.09.0/bin/
export PATH := ${PATH}:${SCRIPTBIN}:${OCAMLBIN}

#
# General targets
#

all : ${EXECBIN}

${EXECBIN} : ${OBJCMX} ${OBJBIN}
	${OCAMLOPT} str.cmxa ${OBJCMX} -o ${EXECBIN}

%.cmi : %.mli
	${OCAMLOPT} -c $<

%.o %.cmx : %.ml
	${OCAMLOPT} -c $<

%.ml : %.mll
	ocamllex $<

%.mli %.ml : %.mly
	ocamlyacc -v $<


MAKEMLI    = ( echo "(* Generated by: ${OCAMLOPT} -i $< *)" \
             ; echo "(* Date: $$(date) *)" \
	     ; ${OCAMLOPT} -i $< \
             ) >$@@

tables.mli : tables.ml absyn.cmi etc.cmi
	${call MAKEMLI}

dumper.mli : dumper.ml absyn.cmi
	${call MAKEMLI}

#
# Misc targets
#

path :
	echo ${PATH}

clean :
	- rm ${OBJCMI} ${OBJCMX} ${OBJBIN} ${GENSOURCE}

spotless : clean
	- rm ${EXECBIN} ${GENFILES} ${LISTING} ${LISTING:.ps=.pdf} 

check : ${ALLSOURCES}
	checksource ${ALLSOURCES}

ci : ${ALLSOURCES}
	cid -is ${ALLSOURCES}

dep : ${MLSOURCE} ${GENSOURCE}
	@@ echo "# Generated: $$(date)" >${DEPFILE}
	ocamldep ${MLSOURCE} ${GENSOURCE} >>${DEPFILE}

${DEPFILE} : tables.mli
	@@touch ${DEPFILE}
	${GMAKE} dep

lis : ${ALLSOURCES} ${DEPFILE}
	mkpspdf ${LISTING} ${ALLSOURCES}

again :
	${GMAKE} spotless
	${GMAKE} dep
	${GMAKE} ci
	${GMAKE} all
	${GMAKE} lis

ifeq "${NEEDINCL}" ""
include ${DEPFILE}
endif

@


1.30
log
@-
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.29 2021-02-04 11:39:48-08 - - $
d64 1
a64 1
tables.mli : tables.ml absyn.cmi
@


1.29
log
@-
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.28 2021-01-29 11:08:27-08 - - $
d64 1
a64 1
tables.mli : tables.ml absyn.cmi etc.cmi
@


1.28
log
@-
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.27 2021-01-26 09:57:09-08 - - $
d64 1
a64 1
tables.mli : tables.ml absyn.cmi
@


1.27
log
@-
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.26 2021-01-26 09:56:33-08 - - $
d29 1
a29 1
OTHERFILES = ${MKFILE} using .ocamlinit
@


1.26
log
@-
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.25 2020-10-29 10:19:55-07 - - $
a57 3
path :
	echo ${PATH}

d73 3
@


1.25
log
@-
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.24 2020-10-22 16:22:53-07 - - $
d33 4
d57 3
@


1.24
log
@-
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.23 2020-10-22 12:41:43-07 - - $
d10 1
a10 1
NOINCLUDE  = ci clean spotless
d29 1
a29 1
OTHERFILES = ${MKFILE} ${DEPFILE} using .ocamlinit
d90 1
a90 1
lis : ${ALLSOURCES}
@


1.23
log
@-
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.22 2020-10-22 12:38:08-07 - - $
d76 3
a79 1
	- checksource ${ALLSOURCES}
@


1.22
log
@-
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.19 2020-09-06 20:49:42-07 - - $
d55 4
a58 1
MAKEMLI    = (echo "(* Generated: $$(date) *)"; ${OCAMLOPT} -i $<) >$@@
@


1.21
log
@-
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.20 2020-10-22 12:29:24-07 - - $
d55 2
d58 1
a58 1
	(echo "(* Generated: $$(date) *)"; ${OCAMLOPT} -i $<) >$@@
d61 1
a61 1
	(echo "(* Generated: $$(date) *)"; ${OCAMLOPT} -i $<) >$@@
@


1.20
log
@-
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.19 2020-09-06 20:49:42-07 - - $
a54 1

@


1.19
log
@-
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.18 2020-08-18 15:53:03-07 - - $
a54 1
MAKEMLI    = (echo "(* Generated: $$(date) *)"; ${OCAMLOPT} -i $<) >$@@
d57 1
a57 1
	${call MAKEMLI}
d60 1
a60 1
	${call MAKEMLI}
@


1.18
log
@-
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.17 2020-08-17 00:02:07-07 - - $
d19 1
a19 1
EXECBIN    = sbinterp
@


1.17
log
@-
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.16 2020-01-28 16:12:50-08 - - $
d9 1
a9 1
DEPSFILE   = ${MKFILE}.deps
d28 2
a29 2
GENFILES   = ${GENSOURCE} parser.output ${DEPSFILE}
OTHERFILES = ${MKFILE} ${DEPSFILE} using .ocamlinit
d77 7
a83 7
deps : ${MLSOURCE} ${GENSOURCE}
	@@ echo "# Generated: $$(date)" >${DEPSFILE}
	ocamldep ${MLSOURCE} ${GENSOURCE} >>${DEPSFILE}

${DEPSFILE} : tables.mli
	@@touch ${DEPSFILE}
	${GMAKE} deps
d90 1
a90 1
	${GMAKE} deps
d96 1
a96 1
include ${DEPSFILE}
@


1.16
log
@-
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.15 2020-01-24 12:54:40-08 - - $
d75 1
a75 1
	cid + ${ALLSOURCES}
@


1.15
log
@-
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.14 2020-01-24 12:43:15-08 - - $
d39 1
a39 1
${EXECBIN} : ${OBJCMX}
d45 1
a45 1
%.cmx : %.ml
@


1.14
log
@-
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.13 2020-01-24 11:50:00-08 - - $
d19 2
a20 2
EXECBIN	   = sbinterp
OBJCMX	   = etc.cmx parser.cmx scanner.cmx tables.cmx \
d22 2
a23 2
OBJCMI	   = ${OBJCMX:.cmx=.cmi} absyn.cmi
OBJBIN	   = ${OBJCMX:.cmx=.o}
@


1.13
log
@-
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.12 2020-01-17 14:21:56-08 - - $
d26 2
a27 1
GENSOURCE  = dumper.mli tables.mli parser.mli parser.ml scanner.ml
@


1.12
log
@-
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.11 2019-02-14 16:13:28-08 - - $
d13 1
d39 1
a39 1
	ocamlopt str.cmxa ${OBJCMX} -o ${EXECBIN}
d42 1
a42 1
	ocamlopt -c $<
d45 1
a45 1
	ocamlopt -c $<
d54 1
a54 1
MAKEMLI    = (echo "(* Generated: $$(date) *)"; ocamlopt -i $<) >$@@
@


1.11
log
@-
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.8 2019-01-25 16:48:22-08 - - $
d19 4
a22 4
OBJCMO	   = etc.cmo parser.cmo scanner.cmo tables.cmo \
             dumper.cmo interp.cmo main.cmo
OBJCMI	   = ${OBJCMO:.cmo=.cmi} absyn.cmi
OBJBIN	   = ${OBJCMO:.cmo=.o}
d37 2
a38 2
${EXECBIN} : ${OBJCMO}
	ocamlc str.cma ${OBJCMO} -o ${EXECBIN}
d41 1
a41 1
	ocamlc -c $<
d43 2
a44 2
%.cmo : %.ml
	ocamlc -c $<
d53 1
a53 1
MAKEMLI    = (echo "(* Generated: $$(date) *)"; ocamlc -i $<) >$@@
d66 1
a66 1
	- rm ${OBJCMI} ${OBJCMO} ${OBJBIN} ${GENSOURCE}
@


1.10
log
@-
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.9 2019-02-14 16:10:09-08 - - $
d87 5
a91 1
	${GMAKE} spotless deps ci all lis
a95 2

etc.ml : etc.cmi
@


1.9
log
@-
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.8 2019-01-25 16:48:22-08 - - $
d92 2
@


1.8
log
@-
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.7 2019-01-25 16:42:31-08 - - $
d87 1
a87 5
	${GMAKE} spotless
	${GMAKE} deps
	${GMAKE} ci
	${GMAKE} all
	${GMAKE} lis
@


1.7
log
@-
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.6 2019-01-25 14:50:51-08 - - $
d72 1
@


1.6
log
@-
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.2 2019-01-25 14:44:50-08 - - $
d53 1
a53 1
MAKEMLI    = (echo "(* Created $$(date) *)"; ocamlc -i $<) >$@@
d75 1
a75 1
	@@ echo "# Created $$(date)" >${DEPSFILE}
@


1.5
log
@-
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.4 2019-01-24 17:08:37-08 - - $
d15 1
a15 1
# File list macros
d53 2
d56 1
a56 2
	@@ echo "(* Created $$(date) *)" >tables.mli
	ocamlc -i tables.ml | sed 's/^type/\n&/' >>tables.mli
d59 1
a59 2
	@@ echo "(* Created $$(date) *)" >dumper.mli
	ocamlc -i dumper.ml >>dumper.mli
@


1.4
log
@-
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.3 2019-01-24 16:25:00-08 - - $
d54 2
a55 3
	( echo "(* Created $$(date) *)" \
	; ocamlc -i tables.ml | sed 's/^type/\n&/' \
	) >tables.mli
d58 2
a59 3
	( echo "(* Created $$(date) *)" \
	; ocamlc -i dumper.ml \
	) >dumper.mli
d75 2
a76 3
	( echo "# Created $$(date)" \
	; ocamldep ${MLSOURCE} ${GENSOURCE} \
	) >${DEPSFILE}
@


1.3
log
@-
@
text
@d1 1
a1 1
# $Id: Makefile,v 1.14 2019-01-24 14:04:36-08 - - $
d19 2
a20 2
OBJCMO	   = etc.cmo parser.cmo scanner.cmo \
             tables.cmo interp.cmo main.cmo
d24 2
a25 2
             interp.mli interp.ml main.ml
GENSOURCE  = tables.mli parser.mli parser.ml scanner.ml
d27 1
a27 1
OTHERFILES = ${MKFILE} ${DEPSFILE} using
d58 5
d68 1
a68 1
	- rm ${OBJCMI} ${OBJCMO} ${OBJBIN} tables.mli
@


1.2
log
@-
@
text
@d19 2
a20 2
OBJCMO	   = etc.cmo parser.cmo scanner.cmo tables.cmo \
             dumper.cmo interp.cmo main.cmo
d24 1
a24 1
             dumper.mli dumper.ml interp.mli interp.ml main.ml
a57 5
dumper.mli : dumper.ml absyn.cmi
	( echo "(* Created $$(date) *)" \
	; ocamlc -i dumper.ml \
	) >dumper.mli

d63 1
a63 1
	- rm ${OBJCMI} ${OBJCMO} ${OBJBIN} ${GENSOURCE}
a70 2
GEN_OCAMLDEP = ocamldep ${MLSOURCE} ${GENSOURCE}
GEN_FORMAT = perl -pe 's/^(.{1,72})\s+(.*)/$$1 \\\n\# $$2/'
d73 1
a73 1
	; ${GEN_OCAMLDEP} \
d76 1
a76 1
${DEPSFILE} : dumper.mli tables.mli
@


1.1
log
@-
@
text
@d19 2
a20 2
OBJCMO	   = etc.cmo parser.cmo scanner.cmo \
             tables.cmo dumper.cmo interp.cmo main.cmo
d24 1
a24 1
             dumper.ml interp.mli interp.ml main.ml
a52 1
GEN_TABLES_MLI = ocamlc -i tables.ml
d54 2
a55 4
	( echo "(* Generated file: DO NOT EDIT *)" \
	; echo "(* ${GEN_TABLES_MLI} *)" \
	; echo "(* Generated $$(date) *)" \
	; ${GEN_TABLES_MLI} | sed 's/^type/\n&/' \
d58 5
d68 1
a68 1
	- rm ${OBJCMI} ${OBJCMO} ${OBJBIN} {GENSOURCE}
d79 1
a79 3
	( echo "# Generated file: DO NOT EDIT" \
	; echo "# ${GEN_OCAMLDEP}" | ${GEN_FORMAT} \
	; echo "# Generated $$(date)" \
d83 1
a83 1
${DEPSFILE} : ${GENSOURCE}
@
